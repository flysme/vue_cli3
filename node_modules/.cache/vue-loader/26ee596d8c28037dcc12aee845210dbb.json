{"remainingRequest":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/moge/dafei/study_project/Vue/test-cli3/src/components/switchStore.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/src/components/switchStore.vue","mtime":1548751603772},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/cache-loader/dist/cjs.js","mtime":1538991184695},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/cache-loader/dist/cjs.js","mtime":1538991184695},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState } from 'vuex'\nexport default {\n  name: 'switchStore',\n  data () {\n    return {\n      showDialog:true,\n      storeInfo:[],\n      switch_id:''\n    }\n  },\n  props: {\n    dialogVisible: {\n      type:Boolean,\n      default:false\n    }\n  },\n  created () {\n    this.getstoreInfo();\n  },\n  computed :{\n    /*是否禁用提交*/\n    isDisabled () {\n      return this.$store.state.login.userInfo.store_id == this.switch_id\n    },\n    isHidden () {\n      this.showDialog = true;\n      return this.dialogVisible;\n    }\n  },\n  methods:{\n    /*关闭dialog*/\n    colseDialog () {\n      this.$emit(\"colseDialog\");\n    },\n    /*新建店铺*/\n    createStore () {\n      this.$router.push({name:'apply'});\n    },\n    getstoreInfo () {\n      let userInfo = this.$store.state.login.userInfo;\n      this.storeInfo = userInfo.store_info;\n      this.switch_id  = userInfo.store_id;\n      this.storeInfo && this.storeInfo.length && this.storeInfo.forEach(item=>{\n          item.active = item._id === userInfo.store_id ? true :false;\n      })\n    },\n    /*切换店铺*/\n    changeStore (store_id) {\n      this.switch_id = store_id;\n      let newstoreInfo = this.storeInfo.map(item=>{\n          item.active = item._id == store_id ? true :false;\n          return item;\n      })\n      this.storeInfo = newstoreInfo;\n    },\n    /*提交切换*/\n    saveStoreInfo () {\n      let userInfo = this.$store.state.login.userInfo;\n      let data = {\n        user_id:userInfo.user_id,\n        store_id:this.switch_id,\n      }\n      this.$store.dispatch('apply/SWITCHSTORE',data)\n      .then(()=>{\n        this.$message.success('店铺切换成功');\n        let route = this.$route;\n        this.$router.push({name:route.name,params:route.params});\n        this.colseDialog();\n      })\n      .catch(()=>{\n        this.$message.success('店铺切换失败');\n      });\n    }\n  }\n}\n",{"version":3,"sources":["switchStore.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"switchStore.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"switchStore\" v-if=\"isHidden\">\n    <el-dialog title=\"切换店铺\" :visible.sync=\"showDialog\" @close=\"colseDialog\">\n      <div class=\"create-new-store sys-flex\">\n          <el-button @click=\"createStore\" type=\"primary\" size=\"mini\">创建店铺</el-button>\n      </div>\n      <div class=\"sys-flex store-list\">\n          <div :class=\"['store-item','sys-flex','rel',item.active ?'active':'']\" @click=\"changeStore(item._id)\" v-for=\"(item,index) in storeInfo\" :key=\"index\">\n              <div class=\"store-icon\">\n                <i class=\"el-icon-vue-dian\"></i>\n              </div>\n              <div class=\"store-name\">{{item.name}}</div>\n              <i v-if=\"item.active\" class=\"el-icon-vue-xuanzhongjiaobiao abs select-icon\"></i>\n          </div>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer sys-flex\">\n        <el-button size=\"medium\" @click=\"colseDialog\">取 消</el-button>\n        <el-button size=\"medium\" :disabled=\"isDisabled\" type=\"primary\" @click=\"saveStoreInfo\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport { mapState } from 'vuex'\nexport default {\n  name: 'switchStore',\n  data () {\n    return {\n      showDialog:true,\n      storeInfo:[],\n      switch_id:''\n    }\n  },\n  props: {\n    dialogVisible: {\n      type:Boolean,\n      default:false\n    }\n  },\n  created () {\n    this.getstoreInfo();\n  },\n  computed :{\n    /*是否禁用提交*/\n    isDisabled () {\n      return this.$store.state.login.userInfo.store_id == this.switch_id\n    },\n    isHidden () {\n      this.showDialog = true;\n      return this.dialogVisible;\n    }\n  },\n  methods:{\n    /*关闭dialog*/\n    colseDialog () {\n      this.$emit(\"colseDialog\");\n    },\n    /*新建店铺*/\n    createStore () {\n      this.$router.push({name:'apply'});\n    },\n    getstoreInfo () {\n      let userInfo = this.$store.state.login.userInfo;\n      this.storeInfo = userInfo.store_info;\n      this.switch_id  = userInfo.store_id;\n      this.storeInfo && this.storeInfo.length && this.storeInfo.forEach(item=>{\n          item.active = item._id === userInfo.store_id ? true :false;\n      })\n    },\n    /*切换店铺*/\n    changeStore (store_id) {\n      this.switch_id = store_id;\n      let newstoreInfo = this.storeInfo.map(item=>{\n          item.active = item._id == store_id ? true :false;\n          return item;\n      })\n      this.storeInfo = newstoreInfo;\n    },\n    /*提交切换*/\n    saveStoreInfo () {\n      let userInfo = this.$store.state.login.userInfo;\n      let data = {\n        user_id:userInfo.user_id,\n        store_id:this.switch_id,\n      }\n      this.$store.dispatch('apply/SWITCHSTORE',data)\n      .then(()=>{\n        this.$message.success('店铺切换成功');\n        let route = this.$route;\n        this.$router.push({name:route.name,params:route.params});\n        this.colseDialog();\n      })\n      .catch(()=>{\n        this.$message.success('店铺切换失败');\n      });\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n  h3 {\n    margin: 40px 0 0;\n  }\n  ul {\n    list-style-type: none;\n    padding: 0;\n    li {\n      display: inline-block;\n      margin: 0 10px;\n      a {\n        color: #42b983;\n      }\n    }\n  }\n  .store-list{\n    width: 100%;\n    flex-wrap: wrap;\n    .store-item{\n      width:25%;\n      height: 50px;\n      border:1px solid #efefef;\n      padding:10px;\n      align-items: center;\n      cursor: pointer;\n      margin:5px;\n      .store-icon{\n        width: 30px;\n        height: 30px;\n        line-height: 33px;\n        border-radius: 30px;\n        border:1px solid #efefef;\n        text-align: center;\n        margin-right: 10px;\n      }\n      .store-name{\n        font-weight: 500;\n        width: 65%;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        word-break: break-all;\n        white-space: nowrap;\n      }\n      &:last-child{\n        margin-right: 0;\n      }\n      .select-icon{\n        bottom: 0;\n        right: 0;\n        bottom: -5px;\n        right: -10px;\n        color: #409EFF;\n        font-size: 20px!important;\n      }\n    }\n    .active{\n      border-color: #409EFF;\n    }\n  }\n  .create-new-store{\n    justify-content: flex-end;\n    padding-bottom: 20px;\n    .el-button{\n      border-radius: 0;\n    }\n  }\n  .dialog-footer{\n    width: 100%;\n    justify-content: center;\n    .el-button{\n      width: 20%;\n      border-radius: 0;\n    }\n  }\n\n</style>\n"]}]}