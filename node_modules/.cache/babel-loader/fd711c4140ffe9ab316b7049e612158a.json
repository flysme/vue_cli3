{"remainingRequest":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/thread-loader/dist/cjs.js!/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/babel-loader/lib/index.js!/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/moge/dafei/study_project/Vue/test-cli3/src/views/Containers/switchstore.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/src/views/Containers/switchstore.vue","mtime":1550114356320},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/cache-loader/dist/cjs.js","mtime":1538991184695},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/cache-loader/dist/cjs.js","mtime":1538991184695},{"path":"/Users/moge/dafei/study_project/Vue/test-cli3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport UTILS from '@/utils/utils';\nexport default {\n  name: 'switchStore',\n  data: function data() {\n    return {\n      storeInfo: [],\n      userInfo: UTILS.storage.get('userinfo'),\n      switch_id: ''\n    };\n  },\n  props: {\n    dialogVisible: {\n      type: Boolean,\n      default: false\n    }\n  },\n  created: function created() {\n    this.getstoreInfo();\n  },\n  computed: {\n    /*是否禁用提交*/\n    isDisabled: function isDisabled() {\n      return (this.userInfo.store_id || this.$store.state.login.userInfo.store_id) == this.switch_id;\n    }\n  },\n  methods: {\n    /*关闭dialog*/\n    colseDialog: function colseDialog() {\n      this.$emit(\"colseDialog\");\n    },\n\n    /*新建店铺*/\n    createStore: function createStore() {\n      this.$router.push({\n        name: 'apply'\n      });\n    },\n    getstoreInfo: function getstoreInfo() {\n      var _this = this;\n\n      var userInfo = UTILS.storage.get('userinfo');\n      this.storeInfo = userInfo.store_info;\n      this.switch_id = userInfo.store_id;\n      this.storeInfo && this.storeInfo.length && this.storeInfo.forEach(function (item) {\n        item.active = false;\n\n        if (item._id == _this.switch_id) {\n          item.active = true;\n        }\n      });\n      this.$store.dispatch('login/GET_STORE_INFO');\n    },\n\n    /*切换店铺*/\n    changeStore: function changeStore(store_id) {\n      this.switch_id = store_id;\n      var newstoreInfo = this.storeInfo.map(function (item) {\n        item.active = item._id == store_id ? true : false;\n        return item;\n      });\n      this.storeInfo = newstoreInfo;\n    },\n\n    /*提交切换*/\n    saveStoreInfo: function saveStoreInfo() {\n      var _this2 = this;\n\n      var data = {\n        store_id: this.switch_id\n      };\n      this.$store.dispatch('apply/SWITCHSTORE', data).then(function () {\n        _this2.$message.success('店铺切换成功');\n\n        _this2.$router.push({\n          name: 'main.container.overview'\n        });\n\n        _this2.colseDialog();\n      }).catch(function () {\n        _this2.$message.success('店铺切换失败');\n      });\n    }\n  }\n};",{"version":3,"sources":["switchstore.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAsBA,OAAA,KAAA,MAAA,eAAA;AACA,eAAA;AACA,QAAA,aADA;AAEA,MAFA,kBAEA;AACA,WAAA;AACA,iBAAA,EADA;AAEA,gBAAA,MAAA,OAAA,CAAA,GAAA,CAAA,UAAA,CAFA;AAGA,iBAAA;AAHA,KAAA;AAKA,GARA;AASA,SAAA;AACA,mBAAA;AACA,YAAA,OADA;AAEA,eAAA;AAFA;AADA,GATA;AAeA,SAfA,qBAeA;AACA,SAAA,YAAA;AACA,GAjBA;AAkBA,YAAA;AACA;AACA,cAFA,wBAEA;AACA,aAAA,CAAA,KAAA,QAAA,CAAA,QAAA,IAAA,KAAA,MAAA,CAAA,KAAA,CAAA,KAAA,CAAA,QAAA,CAAA,QAAA,KAAA,KAAA,SAAA;AACA;AAJA,GAlBA;AAwBA,WAAA;AACA;AACA,eAFA,yBAEA;AACA,WAAA,KAAA,CAAA,aAAA;AACA,KAJA;;AAKA;AACA,eANA,yBAMA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA;AAAA,cAAA;AAAA,OAAA;AACA,KARA;AASA,gBATA,0BASA;AAAA;;AACA,UAAA,WAAA,MAAA,OAAA,CAAA,GAAA,CAAA,UAAA,CAAA;AACA,WAAA,SAAA,GAAA,SAAA,UAAA;AACA,WAAA,SAAA,GAAA,SAAA,QAAA;AACA,WAAA,SAAA,IAAA,KAAA,SAAA,CAAA,MAAA,IAAA,KAAA,SAAA,CAAA,OAAA,CAAA,gBAAA;AACA,aAAA,MAAA,GAAA,KAAA;;AACA,YAAA,KAAA,GAAA,IAAA,MAAA,SAAA,EAAA;AACA,eAAA,MAAA,GAAA,IAAA;AACA;AACA,OALA,CAAA;AAMA,WAAA,MAAA,CAAA,QAAA,CAAA,sBAAA;AACA,KApBA;;AAqBA;AACA,eAtBA,uBAsBA,QAtBA,EAsBA;AACA,WAAA,SAAA,GAAA,QAAA;AACA,UAAA,eAAA,KAAA,SAAA,CAAA,GAAA,CAAA,gBAAA;AACA,aAAA,MAAA,GAAA,KAAA,GAAA,IAAA,QAAA,GAAA,IAAA,GAAA,KAAA;AACA,eAAA,IAAA;AACA,OAHA,CAAA;AAIA,WAAA,SAAA,GAAA,YAAA;AACA,KA7BA;;AA8BA;AACA,iBA/BA,2BA+BA;AAAA;;AACA,UAAA,OAAA;AACA,kBAAA,KAAA;AADA,OAAA;AAGA,WAAA,MAAA,CAAA,QAAA,CAAA,mBAAA,EAAA,IAAA,EACA,IADA,CACA,YAAA;AACA,eAAA,QAAA,CAAA,OAAA,CAAA,QAAA;;AACA,eAAA,OAAA,CAAA,IAAA,CAAA;AAAA,gBAAA;AAAA,SAAA;;AACA,eAAA,WAAA;AACA,OALA,EAMA,KANA,CAMA,YAAA;AACA,eAAA,QAAA,CAAA,OAAA,CAAA,QAAA;AACA,OARA;AASA;AA5CA;AAxBA,CAAA","sourcesContent":["<template>\n  <div class=\"switchStore rel\">\n      <div class=\"create-new-store sys-flex\">\n          <div class=\"header-title\">选择店铺</div>\n          <el-button @click=\"createStore\" type=\"primary\" size=\"mini\">创建店铺</el-button>\n      </div>\n      <div class=\"sys-flex store-list\">\n          <div :class=\"['store-item','sys-flex','rel',item.active ?'active':'']\" @click=\"changeStore(item._id)\" v-for=\"(item,index) in storeInfo\" :key=\"index\">\n              <div class=\"store-icon\">\n                <i class=\"el-icon-vue-dian\"></i>\n              </div>\n              <div class=\"store-name\">{{item.name}}</div>\n              <i v-if=\"item.active\" class=\"el-icon-vue-xuanzhongjiaobiao abs select-icon\"></i>\n          </div>\n      </div>\n      <div  class=\"dialog-footer sys-flex abs\">\n        <el-button size=\"medium\" @click=\"colseDialog\">取 消</el-button>\n        <el-button size=\"medium\" :disabled=\"isDisabled\" type=\"primary\" @click=\"saveStoreInfo\">确 定</el-button>\n      </div>\n  </div>\n</template>\n<script>\nimport UTILS from '@/utils/utils'\nexport default {\n  name: 'switchStore',\n  data () {\n    return {\n      storeInfo:[],\n      userInfo:UTILS.storage.get('userinfo'),\n      switch_id:''\n    }\n  },\n  props: {\n    dialogVisible: {\n      type:Boolean,\n      default:false\n    }\n  },\n  created () {\n    this.getstoreInfo();\n  },\n  computed :{\n    /*是否禁用提交*/\n    isDisabled () {\n      return (this.userInfo.store_id || this.$store.state.login.userInfo.store_id) == this.switch_id\n    }\n  },\n  methods:{\n    /*关闭dialog*/\n    colseDialog () {\n      this.$emit(\"colseDialog\");\n    },\n    /*新建店铺*/\n    createStore () {\n      this.$router.push({name:'apply'});\n    },\n    getstoreInfo () {\n      let userInfo = UTILS.storage.get('userinfo');\n      this.storeInfo = userInfo.store_info;\n      this.switch_id  = userInfo.store_id;\n      this.storeInfo && this.storeInfo.length && this.storeInfo.forEach(item=>{\n          item.active = false;\n          if (item._id == this.switch_id) {\n            item.active = true;\n          }\n      })\n      this.$store.dispatch('login/GET_STORE_INFO');\n    },\n    /*切换店铺*/\n    changeStore (store_id) {\n      this.switch_id = store_id;\n      let newstoreInfo = this.storeInfo.map(item=>{\n          item.active = item._id == store_id ? true :false;\n          return item;\n      })\n      this.storeInfo = newstoreInfo;\n    },\n    /*提交切换*/\n    saveStoreInfo () {\n      let data = {\n        store_id:this.switch_id\n      }\n      this.$store.dispatch('apply/SWITCHSTORE',data)\n      .then(()=>{\n        this.$message.success('店铺切换成功');\n        this.$router.push({name:'main.container.overview'});\n        this.colseDialog();\n      })\n      .catch(()=>{\n        this.$message.success('店铺切换失败');\n      });\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n  .switchStore{\n    width: 80%;\n    border:1px solid #efefef;\n    margin:100px auto;\n    box-shadow: 0 0  1px #efefef;\n    min-height: 400px;\n    padding:0 20px 20px 20px;\n    .store-list{\n      width: 100%;\n      flex-wrap: wrap;\n      .store-item{\n        width:25%;\n        height: 80px;\n        border:1px solid #efefef;\n        padding:10px;\n        align-items: center;\n        cursor: pointer;\n        margin:5px;\n        .store-icon{\n          width: 40px;\n          height: 40px;\n          line-height: 43px;\n          border-radius: 40px;\n          border:1px solid #efefef;\n          text-align: center;\n          margin-right: 10px;\n        }\n        .store-name{\n          font-weight: 500;\n          width: 65%;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          word-break: break-all;\n          white-space: nowrap;\n        }\n        &:last-child{\n          margin-right: 0;\n        }\n        .select-icon{\n          bottom: 0;\n          right: 0;\n          bottom: -6px;\n          right: -11px;\n          color: #409EFF;\n          font-size: 24px!important;\n        }\n      }\n      .active{\n        border-color: #409EFF;\n      }\n    }\n    .create-new-store{\n      height: 50px;\n      justify-content: space-between;\n      align-items: center;\n      border-bottom: 1px solid #efefef;\n      margin-bottom: 20px;\n      .header-title{\n        font-weight: 500;\n      }\n      .el-button{\n        border-radius: 0;\n      }\n    }\n    .dialog-footer{\n      width: 100%;\n      left: 0;\n      bottom: 20px;\n      margin:0;\n      justify-content: center;\n      .el-button{\n        width: 20%!important;\n        flex:0;\n        border-radius: 0;\n      }\n    }\n  }\n</style>\n"],"sourceRoot":"src/views/Containers"}]}