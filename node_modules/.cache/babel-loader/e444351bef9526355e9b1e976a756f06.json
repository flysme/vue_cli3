{"remainingRequest":"/Users/moge/dafei/study_project/Vue/saas/node_modules/babel-loader/lib/index.js!/Users/moge/dafei/study_project/Vue/saas/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/moge/dafei/study_project/Vue/saas/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/moge/dafei/study_project/Vue/saas/src/views/Containers/goods/goodsList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/moge/dafei/study_project/Vue/saas/src/views/Containers/goods/goodsList.vue","mtime":1550126252510},{"path":"/Users/moge/dafei/study_project/Vue/saas/node_modules/cache-loader/dist/cjs.js","mtime":1538991184695},{"path":"/Users/moge/dafei/study_project/Vue/saas/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/moge/dafei/study_project/Vue/saas/node_modules/cache-loader/dist/cjs.js","mtime":1538991184695},{"path":"/Users/moge/dafei/study_project/Vue/saas/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"/Users/moge/dafei/study_project/Vue/saas/node_modules/@babel/runtime/helpers/builtin/es6/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport UTILS from '@/utils/utils';\nimport config from '@/config/config';\nimport { mapState } from 'vuex';\nexport default {\n  name: 'goodList',\n  data: function data() {\n    return {\n      loading: true,\n      multiProductList: [],\n      disabled: true,\n      searchcatsvalue: '',\n      catesgory_id: '',\n      searchvalue: '',\n      //搜索关键字\n      userinfo: UTILS.storage.get('userinfo')\n    };\n  },\n  computed: _objectSpread({\n    cansearchFilter: function cansearchFilter() {\n      return this.searchvalue == '';\n    },\n    resetResponData: function resetResponData() {\n      var goodList = this.$store.state.product.goodList;\n      var resetData = goodList.map(function (item) {\n        item.ident_name = item.status == 1 ? '已上架' : '已下架';\n        item.img = config.Imghost + (item.img != '' ? item.img : config.goodsIcon);\n        return item;\n      });\n      console.log(resetData, 'resetData', config.Imghost);\n      return resetData;\n    }\n  }, mapState('product_category', {\n    // 箭头函数可使代码更简练\n    categorysList: function categorysList(state) {\n      return state.categorysList;\n    }\n  }), mapState('login', {\n    storeStatus: function storeStatus(state) {\n      return state.storeStatus;\n    }\n  })),\n  created: function created() {\n    this.getCategorys();\n    this.getProducts();\n  },\n  methods: {\n    toggleSelection: function toggleSelection(rows) {\n      var _this = this;\n\n      if (rows) {\n        rows.forEach(function (row) {\n          _this.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n\n    /*列表全选*/\n    selectAllItem: function selectAllItem(val) {\n      this.multiProductList = val;\n      this.disabled = this.multiProductList.length ? false : true;\n    },\n\n    /*获取商品分类*/\n    getCategorys: function getCategorys() {\n      var data = {\n        store_id: this.userinfo.store_id || this.userinfo.store_info[0]['_id']\n      };\n      this.$store.dispatch('product_category/GET_CATEGORYS', data);\n    },\n\n    /*分类搜索*/\n    selectCats: function selectCats() {\n      this.getProducts();\n    },\n\n    /*获取商品*/\n    getProducts: function getProducts() {\n      var _this2 = this;\n\n      var data = {\n        store_id: this.userinfo.store_id || this.userinfo.store_info[0]['_id']\n      };\n\n      if (this.searchvalue != '') {\n        data.product_name = this.searchvalue;\n      }\n\n      if (this.catesgory_id != '') {\n        data.catesgory_id = this.catesgory_id;\n      }\n\n      this.loading = true;\n      this.$store.dispatch('product/LOAD_GOODSLIST', data).then(function () {\n        _this2.loading = false;\n      }).catch(function (err) {\n        _this2.isloading = false;\n      }).finally(function () {\n        _this2.isloading = false;\n      });\n    },\n    editGoods: function editGoods(item) {\n      this.$router.push({\n        path: \"/goods/editgoods/\".concat(item.product_id)\n      });\n    },\n\n    /*点击更多*/\n    setItemhandle: function setItemhandle(item) {\n      var status = item.status == 1 ? 0 : 1;\n      this.updateProductstatus([item.product_id], status);\n    },\n\n    /*商品全选操作*/\n    changeProducts: function changeProducts(status) {\n      var product_ids = this.multiProductList.map(function (item) {\n        return item.product_id;\n      });\n      this.updateProductstatus(product_ids, status);\n    },\n\n    /*更新商品状态*/\n    updateProductstatus: function updateProductstatus(product_ids, status) {\n      var _this3 = this;\n\n      var data = {\n        status: status,\n        product_ids: product_ids\n      };\n      this.$store.dispatch('product/UPDATE_GOODSITEM', data).then(function () {\n        _this3.getProducts();\n      });\n    },\n\n    /*商品名称搜索*/\n    searchFilter: function searchFilter() {\n      this.getProducts();\n    },\n\n    /*商品分类搜索*/\n    setcatsSearch: function setcatsSearch(command) {\n      this.$message('click on item ' + command);\n    },\n    add: function add() {\n      this.$router.push({\n        name: 'main.container.goods.addgoods'\n      });\n    } // ...mapActions({\n    //   add: 'goodsList/LOAD_GOODSLIST'  /*新增商品*/\n    // })\n\n  }\n};",{"version":3,"sources":["goodsList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"goodList\">\n    <el-row type=\"flex\" justify=\"space-between\">\n      <el-col :span=\"9\">\n        <div class=\"sys-flex\">\n          <div class=\"grid-content search-main sys-flex\">\n            <el-input\n            size=\"small\"\n            v-model=\"searchvalue\"\n            placeholder=\"搜索\"\n            ></el-input>\n            <div class=\"search-btn\">\n              <el-button size=\"small\" type=\"primary\" :disabled=\"cansearchFilter\" plain @click=\"searchFilter\">筛选</el-button>\n            </div>\n          </div>\n          <div class=\"grid-content search-cats-main sys-flex\">\n            <el-select @change=\"selectCats\" v-model=\"catesgory_id\" placeholder=\"分类搜索\" size=\"small\">\n              <el-option :label=\"cateitem.category_name\" :value=\"cateitem.category_id\" :key=\"index\"  v-for=\"(cateitem,index) in categorysList\" ></el-option>\n            </el-select>\n          </div>\n        </div>\n      </el-col>\n      <el-col :span=\"3\">\n         <div class=\"btn-add sys-flex\">\n           <el-button size=\"small\" type=\"primary\" :disabled=\"!storeStatus.canhandle\"  @click=\"add\">新增商品</el-button>\n         </div>\n      </el-col>\n    </el-row>\n    <el-table\n      :data=\"resetResponData\"\n      ref=\"multipleTable\"\n      tooltip-effect=\"dark\"\n      @selection-change=\"selectAllItem\"\n      v-loading=\"loading\"\n      style=\"width: 100%\">\n      <el-table-column\n        type=\"selection\"\n        width=\"33\">\n      </el-table-column>\n      <el-table-column\n        prop=\"img\"\n        label=\"商品图\"\n        width=\"100\">\n        <img slot-scope=\"scope\" :src=\"scope.row.img\" width=\"50\" height=\"50\"/>\n      </el-table-column>\n      <el-table-column\n        prop=\"title\"\n        label=\"商品名称\"\n        width=\"180\">\n      </el-table-column>\n      <el-table-column\n        prop=\"ident_name\"\n        label=\"状态\">\n      </el-table-column>\n      <el-table-column\n        prop=\"num\"\n        label=\"库存\"\n        width=\"100\">\n      </el-table-column>\n      <el-table-column\n        prop=\"create_time\"\n        label=\"创建时间\">\n      </el-table-column>\n      <el-table-column\n        fixed=\"right\"\n        label=\"操作\"\n        width=\"100\">\n        <template slot-scope=\"scope\">\n          <el-button @click=\"editGoods(scope.row)\" type=\"text\" size=\"small\">编辑</el-button>\n          <span> - </span>\n          <el-dropdown @command=\"setItemhandle\" trigger=\"click\" size=\"mini\">\n              <el-button  type=\"text\" size=\"small\">更多</el-button>\n              <el-dropdown-menu slot=\"dropdown\">\n                <el-dropdown-item :command=\"scope.row\">{{scope.row.status=='1' ? '下架':'上架'}}</el-dropdown-item>\n              </el-dropdown-menu>\n          </el-dropdown>\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-row>\n      <el-col :span=\"8\">\n            <el-button size=\"mini\" :disabled=\"disabled\" @click=\"changeProducts(1)\">上架</el-button>\n            <el-button size=\"mini\" :disabled=\"disabled\" @click=\"changeProducts(0)\">下架</el-button>\n            <el-button size=\"mini\" :disabled=\"disabled\" @click=\"changeProducts(2)\">删除</el-button>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport UTILS from '@/utils/utils'\nimport config from '@/config/config'\nimport { mapState } from 'vuex'\nexport default {\n  name: 'goodList',\n  data () {\n    return {\n      loading:true,\n      multiProductList: [],\n      disabled: true,\n      searchcatsvalue:'',\n      catesgory_id:'',\n      searchvalue: '', //搜索关键字\n      userinfo:UTILS.storage.get('userinfo'),\n    }\n  },\n  computed: {\n    cansearchFilter () {\n      return this.searchvalue=='';\n    },\n    resetResponData () {\n      let goodList = this.$store.state.product.goodList;\n      let resetData = goodList.map(item => {\n         item.ident_name = item.status==1 ? '已上架' : '已下架'\n         item.img = config.Imghost + (item.img!='' ?  item.img : config.goodsIcon)\n         return item;\n      })\n      console.log(resetData,'resetData',config.Imghost)\n      return resetData\n    },\n    ...mapState('product_category',{\n        // 箭头函数可使代码更简练\n        categorysList: state => state.categorysList\n    }),\n    ...mapState('login',{\n        storeStatus:state => state.storeStatus,\n    })\n  },\n  created () {\n    this.getCategorys();\n    this.getProducts();\n  },\n  methods: {\n    toggleSelection(rows) {\n      if (rows) {\n        rows.forEach(row => {\n          this.$refs.multipleTable.toggleRowSelection(row);\n        });\n      } else {\n        this.$refs.multipleTable.clearSelection();\n      }\n    },\n    /*列表全选*/\n    selectAllItem(val) {\n      this.multiProductList = val;\n      this.disabled = this.multiProductList.length ? false : true\n    },\n    /*获取商品分类*/\n    getCategorys () {\n      let data = {\n        store_id:this.userinfo.store_id || this.userinfo.store_info[0]['_id']\n      }\n      this.$store.dispatch('product_category/GET_CATEGORYS',data)\n    },\n    /*分类搜索*/\n    selectCats () {\n      this.getProducts();\n    },\n    /*获取商品*/\n    getProducts () {\n      let data = {\n        store_id:this.userinfo.store_id || this.userinfo.store_info[0]['_id'],\n      }\n      if (this.searchvalue!='') {\n        data.product_name=this.searchvalue;\n      }\n      if (this.catesgory_id!='') {\n        data.catesgory_id=this.catesgory_id;\n      }\n      this.loading = true;\n      this.$store.dispatch('product/LOAD_GOODSLIST',data).then(()=>{\n        this.loading = false;\n      }).catch(err=>{\n        this.isloading = false;\n      }).finally(()=>{\n        this.isloading = false;\n      })\n    },\n    editGoods (item) {\n      this.$router.push({path: `/goods/editgoods/${item.product_id}`});\n    },\n    /*点击更多*/\n    setItemhandle(item) {\n      let status = item.status==1 ? 0: 1;\n      this.updateProductstatus([item.product_id],status);\n    },\n    /*商品全选操作*/\n    changeProducts (status) {\n      let product_ids = this.multiProductList.map(item=>(item.product_id));\n      this.updateProductstatus(product_ids,status);\n    },\n    /*更新商品状态*/\n    updateProductstatus (product_ids,status) {\n      let data = {status,product_ids};\n      this.$store.dispatch('product/UPDATE_GOODSITEM',data).then(()=>{\n        this.getProducts();\n      });\n    },\n    /*商品名称搜索*/\n    searchFilter () {\n      this.getProducts();\n    },\n    /*商品分类搜索*/\n    setcatsSearch (command) {\n      this.$message('click on item ' + command);\n    },\n    add () {\n      this.$router.push({name: 'main.container.goods.addgoods'});\n    }\n    // ...mapActions({\n    //   add: 'goodsList/LOAD_GOODSLIST'  /*新增商品*/\n    // })\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n  #goodList{\n    background-color: #FFF;\n    .search-main{\n      justify-content: space-between;\n      .search-btn{\n        margin-left: 20px;\n      }\n    }\n    .search-cats-main{\n      margin-left:40px;\n    }\n    .btn-add{\n      justify-content: flex-end;\n      margin-right: 10px;\n    }\n    .el-col{\n      margin:10px;\n    }\n  }\n</style>\n"],"sourceRoot":"src/views/Containers/goods"}]}